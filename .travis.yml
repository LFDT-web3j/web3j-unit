language: java
jdk:
- openjdk11
sudo: false
before_cache:
- rm -f  $HOME/.gradle/caches/modules-2/modules-2.lock
- rm -fr $HOME/.gradle/caches/*/plugin-resolution/
cache:
  directories:
  - "$HOME/.gradle/caches/"
  - "$HOME/.gradle/wrapper/"
install: skip
test: skip
jobs:
  include:
  - stage: build pull request
    script: "./gradlew check jacocoTestReport"
    if: type = pull_request
  - stage: build master
    script: "./gradlew check jacocoTestReport publish"
    if: branch = master AND NOT type = pull_request
  - stage: build and stage release
    if: branch =~ /release/
    script: "./gradlew check publish -Pversion=${TRAVIS_BRANCH#'release/'}"
  - stage: release
    if: branch =~ /release/
    script: "./gradlew closeAndReleaseRepository"
  - stage: github release
    if: branch =~ /release/
    script: "./gradlew check -Pversion=${TRAVIS_BRANCH#'release/'} && ./scripts/github-release.sh"
after_success:
- bash <(curl -s https://codecov.io/bash)
before_install:
- |
  if [[ "$TRAVIS_PULL_REQUEST" = "false" ]]; then
    openssl aes-256-cbc -K $encrypted_41922466f452_key -iv $encrypted_41922466f452_iv -in web3j.asc.enc -out web3j.asc -d
  fi
env:
  global:
  - secure: FM+blnQPkd/syJ35SYRWZT+3uUPEIUR8ozWlFtYz2AQTMgksrNQ8PBLgWCeH35PxZEWHmtttChFbuUzwXlGZm/16/bxGgZtCHO1bOZq4Ojy9QoIBBo0zeEZ4eq0FBdRA+XfuXR34wu107KxvM5A5JccoPLwNj8zMHSGVBwrHX9DBwVh+PsdJ7qnBj3gZUbRHo1Yan/mgCwOEvY5L8BtgO29K5453WVTo9gBqrm+JsD9yhyfDl1vLf3mV372uz+KLhP9YxUHERDeBHJZv7KNEBZQk8zDNrHwmTsm00sCaw9nEj1rhK36VJ42UAPGFFZeT9K49BkDkTjdBeqrkSZp/hbgfvLOekAWLuM68rqv3Yll9gat35mRKUgqNr/Cv/BZVqywwXJOeG9c37dPS/OIltP9CHM/TUbPa99CK+OKdZf3DC6OrOIMWR2RY1Z1eXPp/pKv84bQxsXmEkZ1d4z8YD1a1LdjPKIBWsGNjxM7la/9js2n2agswRtyWQ9OXKm+EepHg7mFMlCZo8uF82N4OK0uFLyLrK2IR9b6Rq1iL1vO+YzAu22nx+2qqc2Xi3jVY9xr5PS9n13LP8KOjIUpX9J1dCERIGoY5gOEuyBRYTjQul6dDHDKkbWZ8ZZFgfKVVX4S2eLE6h3fSjTq3uYUMJqxTtLv2JDHZQiZe8WGR/yo=
  - secure: JfNiMHnAUstdg5XoDX9PcGzTe3Zjxqx/VawJ043xKKVDxFqGWhEP67LmlrAd9aKc7GmSCN+JqdP4SAYCLiaTSbgbyPZwhqdmDxrM9xULa7LXSzsVrW8x78VyR2tEHYf6qmZpsc8T3rTByQZm5LWT65nC2rkdAh4rXLjWkMLc/rMWVSJHC5pj087DQJPqx7yGXptOFhSm1AClRxq4mPHf/OnUGBELo1ammPJs48v9BiRSCDjxZXwZ1pFoq1rvTI/KVs39Gn3TMInLyzSRmynceLO5yNGSiDJK3dW2poOG0DLUB6Q1zya10kSr1cV+gRXBMMPsqLlWJkPEpdBqVzpSuAdLMGMDQ2sJtK1kky+lxOf+Zc03Eb8vcxkeWmXzBBJ+MRd//LqcCGGL3lsNp09M97lsKjq4PQTpxLDsVRU2vM1f4+a3xqTmKWqNCV2r8LxqcY5Ts8zjn+psF7CV3Lx0ule/QfaYcgHGMOXi3sUlf23xVHB6sdW4UIrDTT+G9ycCbpgNGhd12m+zqWI7R558Y/OEsqyr2kDYXSpEaE7U1G3lMQ7yha2emLb5F7pO+pevNxr6nLHQDYh4Y54y5AlJkzXQkIgy5ffb/HgRwvMuHw9I0S8wptSYXpc92uth9N/uuG8qYdrXr4ItTeF4TI3YPqnCuNmXbrct1fqj16NaGrk=
  - secure: O/9cDT9aUF5WVwy72YCC+MLIE2mPdjVovw8wCw7ZhZJQEK2mmBq4K0pBPIJW4EC4FBFViRkLuILwtGyY9zjNvLH9ordUBZff9rMrtoUNBYjExJOlfb/Fj0O0sU76tI0GUyN2jw5Lx0ysJz64FkhrhqNLwrQmbXMGOdWF4OsGcXyM9Rogq3NW4WFtcYj9xHabFvnh+1qG342nH59ytbkbX59XYvIZYzrr7knuYUkG9PiLZFTJdvCtOcH4eNZY3cz19cTAEc9aN6ho76AueFXdd0J0lvrL07/uClKNuZdJ5FVszPTJXqalX9Je1e5jQIGgxPdQJH2zWM6/1z/5uF1VokSsxEp5jydr+2C+xvXQcUjlFuENz4ZpHgfiZ9/NcOTD/+fmO9FvEeb5TTYOyWbkNSuGfkxKz/qM5posXVDJjhrU05fKwhzvocQ/ZsOr8rNPYypCeTroY5WumPvjAUukrbBgAHPt0E7IIShpotkhOFDzdOfKNYFaMLvme4dB5au2EBeLxtewpYqHW2pFLJbCXEYu4r47coUngvHGa83GxcWHR0KHC8RA+RbI+IqQs6wsWpKSqphWyiLjDBNhO7FlxaTKVwsH5y2AGhGhH4wDKoGhiJ3sxVDWPB5AAAwq6QSrl6JTu3ninRBHNJtu1DW8/bzbmAMizqje9qL7cKl3aWI=
  - secure: lKDrc+hV7eJnQmHANnwk25Kn9tW/mB/3i5rvFrARjqtGFpHQ0GJOBfAOa1zeKNilusMLQqIxKZU1wVL9diA6wc8G9a8f7wVvwHizfxhvF894rqeVK5RhhpnVbLIESoYvCVWenm58HufuwAr0lbO4VnmzmFHRVwG8tdlA4l9s6uihW8/hnnP7bKKuvB+7qkoKa3n8v+8rosUmLyZtqI7ZcwLGx7IzumQ8zopJy2DwoTmyPCN019MSGUNvLkPMITNtzjW52swQZV80Z0n3TmYGUYBlTj8qcJUyb5RWQYnQjQM0DDpoMx3VV64q+YI5TjdZ6mUYbIDqoNDO/OSPN7P6dcpF3jZYOLUjuA65ZEmT3ZpKESMv9wsrXhZDxnCtNefwJjoVXARXkBHz18fLJLaxrWoEAIrXKRwdy1hS6xTXNGjkFo0LUksW58QCmV2oSSw+JFlnhfiXnIZrc8WpTirLytYBb0ZsvzaoiaYoINE6/smwCCVGlibY0EMd9jLjAUR7+xqUgD7T5nzYKXdp9FoHVuk/hmBYyaQbRpd+jtzMVexn2CR3/mFCuMELaO2fW04qlzGtmaOxUMfJJQT7NLh6cOYBlKG5+gC8YFICsh0nLNgCsLkBoEaWepzyYHmlvEPkmilmfHzDc9ZSiTYlogmZoKRBF6wgJ1SjYDPSxRcaPlg=
